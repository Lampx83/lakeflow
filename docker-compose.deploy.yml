# Override dùng khi deploy lên server (chạy cùng docker-compose.yml)
# Ví dụ: docker compose -f docker-compose.yml -f docker-compose.deploy.yml up -d --build
#
# Data lake path:
#   Local (dev): docker-compose.yml → /Users/mac/Library/CloudStorage/SynologyDrive-research
#   Server:      docker-compose.deploy.yml → /datalake/research
#
# - Backend: bỏ mount source, bỏ --reload
# - Frontend: bỏ mount ./backend

services:
  lakeflow-backend:
    volumes:
      - lakeflow_data:/data
    command: uvicorn lakeflow.main:app --host 0.0.0.0 --port 8011

  lakeflow-frontend:
    volumes:
      - lakeflow_data:/data

# Ghi đè volume: bind mount /datalake/research trên server (tránh path Mac từ docker-compose.yml)
volumes:
  lakeflow_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /datalake/research